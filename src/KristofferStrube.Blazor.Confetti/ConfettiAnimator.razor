@using KristofferStrube.Blazor.SVGAnimation
@using Microsoft.JSInterop

<g>
    @if (ConfettiPiece.Type is ConfettiType.SkewedRectangle)
    {
        <path fill="@ConfettiPiece.Color" d="M -20 -20 l @ConfettiPiece.Size 2 2 @ConfettiPiece.Size -@ConfettiPiece.Size -2 z"></path>
    }
    else if (ConfettiPiece.Type is ConfettiType.Heart)
    {
        <g transform="scale(@(@ConfettiPiece.Size / 20))">
            <g filter="url(#filter0_ii_18_4033)">
                <path d="M21.0084 5.3171C18.1675 5.81911 15.9969 9.17258 15.9969 9.17258C15.9969 9.17258 13.8162 5.81911 10.9854 5.3171C3.97328 4.08214 1.08242 10.2469 2.25277 14.8353C3.98329 21.6126 12.3058 27.687 15.0866 29.5645C15.6367 29.936 16.357 29.936 16.9171 29.5645C19.708 27.687 28.0304 21.6126 29.7509 14.8353C30.9113 10.2469 28.0204 4.08214 21.0084 5.3171Z" fill="url(#paint0_linear_18_4033)" />
                <path d="M21.0084 5.3171C18.1675 5.81911 15.9969 9.17258 15.9969 9.17258C15.9969 9.17258 13.8162 5.81911 10.9854 5.3171C3.97328 4.08214 1.08242 10.2469 2.25277 14.8353C3.98329 21.6126 12.3058 27.687 15.0866 29.5645C15.6367 29.936 16.357 29.936 16.9171 29.5645C19.708 27.687 28.0304 21.6126 29.7509 14.8353C30.9113 10.2469 28.0204 4.08214 21.0084 5.3171Z" fill="url(#paint1_radial_18_4033)" />
                <path d="M21.0084 5.3171C18.1675 5.81911 15.9969 9.17258 15.9969 9.17258C15.9969 9.17258 13.8162 5.81911 10.9854 5.3171C3.97328 4.08214 1.08242 10.2469 2.25277 14.8353C3.98329 21.6126 12.3058 27.687 15.0866 29.5645C15.6367 29.936 16.357 29.936 16.9171 29.5645C19.708 27.687 28.0304 21.6126 29.7509 14.8353C30.9113 10.2469 28.0204 4.08214 21.0084 5.3171Z" fill="url(#paint2_radial_18_4033)" />
            </g>
            <g filter="url(#filter1_f_18_4033)">
                <path d="M15.9566 14.7618V9.48572C16.6852 8.58125 18.8144 7.32925 19.788 6.81631C17.4514 8.95185 16.2602 13.0031 15.9566 14.7618Z" fill="url(#paint3_linear_18_4033)" />
            </g>
            <g filter="url(#filter2_f_18_4033)">
                <path d="M15.9566 14.7618V9.48572C15.228 8.58125 13.0987 7.32925 12.1252 6.81631C14.4617 8.95185 15.653 13.0031 15.9566 14.7618Z" fill="url(#paint4_linear_18_4033)" />
            </g>
        </g>
    }
    else if (ConfettiPiece.Type is ConfettiType.HandsClapping)
    {
        <g transform="translate(0, -100) scale(@(@ConfettiPiece.Size / 20))">
            <g filter="url(#filter0_i_20020_3536)">
                <path d="M13.6398 8.8854C13.6586 8.20501 14.0201 7.5507 14.6516 7.18607C15.6 6.63854 16.8118 6.94433 17.3868 7.87626L21.1951 14.0482C21.8445 15.1008 21.4912 16.4821 20.4161 17.0935C19.3615 17.6933 18.0202 17.3186 17.4291 16.2591L17.169 15.7928C17.0382 16.4018 16.6587 16.9557 16.0725 17.2892C15.6066 17.5543 15.0868 17.6364 14.596 17.5585L14.6268 17.612C14.9574 18.1845 14.9923 18.8476 14.7775 19.4233L21.5248 29.0781C20.7435 29.5468 18.6576 30.4374 15.7201 29.6718C13.0091 28.7968 11.6654 27.2499 10.7279 25.6562L5.82611 17.2899C5.23386 16.2759 5.57932 14.9736 6.59628 14.3865C6.97428 14.1682 7.39157 14.0797 7.7966 14.1071L7.41611 13.4241C6.86426 12.4336 7.2095 11.1835 8.19147 10.6166C8.63382 10.3612 9.13111 10.2871 9.59723 10.3714L9.51999 10.2327C8.95972 9.22703 9.31024 7.95781 10.3073 7.38218C11.2936 6.81274 12.5538 7.12997 13.153 8.0985L13.6398 8.8854Z" fill="url(#paint0_radial_20020_3536)" />
                <path d="M13.6398 8.8854C13.6586 8.20501 14.0201 7.5507 14.6516 7.18607C15.6 6.63854 16.8118 6.94433 17.3868 7.87626L21.1951 14.0482C21.8445 15.1008 21.4912 16.4821 20.4161 17.0935C19.3615 17.6933 18.0202 17.3186 17.4291 16.2591L17.169 15.7928C17.0382 16.4018 16.6587 16.9557 16.0725 17.2892C15.6066 17.5543 15.0868 17.6364 14.596 17.5585L14.6268 17.612C14.9574 18.1845 14.9923 18.8476 14.7775 19.4233L21.5248 29.0781C20.7435 29.5468 18.6576 30.4374 15.7201 29.6718C13.0091 28.7968 11.6654 27.2499 10.7279 25.6562L5.82611 17.2899C5.23386 16.2759 5.57932 14.9736 6.59628 14.3865C6.97428 14.1682 7.39157 14.0797 7.7966 14.1071L7.41611 13.4241C6.86426 12.4336 7.2095 11.1835 8.19147 10.6166C8.63382 10.3612 9.13111 10.2871 9.59723 10.3714L9.51999 10.2327C8.95972 9.22703 9.31024 7.95781 10.3073 7.38218C11.2936 6.81274 12.5538 7.12997 13.153 8.0985L13.6398 8.8854Z" fill="url(#paint1_radial_20020_3536)" />
            </g>
            <path d="M8.19148 10.6167C7.20951 11.1836 6.86427 12.4337 7.41612 13.4242L7.79661 14.1072C8.47746 14.1532 9.12367 14.5267 9.49049 15.162L12.7503 20.8082C13.1353 20.8142 13.5269 20.716 13.8819 20.502C14.876 19.9025 15.2073 18.6175 14.6268 17.6121L11.0267 11.3764C10.4535 10.3837 9.18419 10.0435 8.19148 10.6167Z" fill="url(#paint2_radial_20020_3536)" />
            <path d="M8.19148 10.6167C7.20951 11.1836 6.86427 12.4337 7.41612 13.4242L7.79661 14.1072C8.47746 14.1532 9.12367 14.5267 9.49049 15.162L12.7503 20.8082C13.1353 20.8142 13.5269 20.716 13.8819 20.502C14.876 19.9025 15.2073 18.6175 14.6268 17.6121L11.0267 11.3764C10.4535 10.3837 9.18419 10.0435 8.19148 10.6167Z" fill="url(#paint3_radial_20020_3536)" />
            <path d="M10.3072 7.38223C9.31023 7.95786 8.95971 9.22708 9.51998 10.2328L9.59722 10.3714C10.1772 10.4762 10.7089 10.826 11.0267 11.3763L14.596 17.5586C15.0868 17.6364 15.6066 17.5544 16.0725 17.2893C17.1901 16.6533 17.5565 15.2166 16.88 14.123L13.153 8.09855C12.5538 7.13002 11.2935 6.81279 10.3072 7.38223Z" fill="url(#paint4_radial_20020_3536)" />
            <path d="M10.3072 7.38223C9.31023 7.95786 8.95971 9.22708 9.51998 10.2328L9.59722 10.3714C10.1772 10.4762 10.7089 10.826 11.0267 11.3763L14.596 17.5586C15.0868 17.6364 15.6066 17.5544 16.0725 17.2893C17.1901 16.6533 17.5565 15.2166 16.88 14.123L13.153 8.09855C12.5538 7.13002 11.2935 6.81279 10.3072 7.38223Z" fill="url(#paint5_radial_20020_3536)" />
            <path d="M13.6398 8.8854L16.88 14.123C17.2017 14.643 17.2876 15.2406 17.169 15.7928L17.4291 16.2591C18.0202 17.3186 19.3615 17.6933 20.4161 17.0935C21.4912 16.4821 21.8445 15.1008 21.1951 14.0482L17.3868 7.87626C16.8118 6.94433 15.6 6.63854 14.6516 7.18607C14.0201 7.5507 13.6586 8.20501 13.6398 8.8854Z" fill="url(#paint6_radial_20020_3536)" />
            <path d="M13.6398 8.8854L16.88 14.123C17.2017 14.643 17.2876 15.2406 17.169 15.7928L17.4291 16.2591C18.0202 17.3186 19.3615 17.6933 20.4161 17.0935C21.4912 16.4821 21.8445 15.1008 21.1951 14.0482L17.3868 7.87626C16.8118 6.94433 15.6 6.63854 14.6516 7.18607C14.0201 7.5507 13.6586 8.20501 13.6398 8.8854Z" fill="url(#paint7_radial_20020_3536)" />
            <rect x="4.75702" y="15.5186" width="4.22359" height="14.5754" rx="2.1118" transform="rotate(-31.6469 4.75702 15.5186)" fill="url(#paint8_radial_20020_3536)" />
            <g filter="url(#filter1_f_20020_3536)">
                <path d="M8.5634 15.1941L11.033 19.4388" stroke="url(#paint9_linear_20020_3536)" stroke-linecap="round" />
            </g>
            <g filter="url(#filter2_f_20020_3536)">
                <path d="M10.0918 11.6698L12.2859 15.3646" stroke="url(#paint10_linear_20020_3536)" stroke-linecap="round" />
            </g>
            <g filter="url(#filter3_f_20020_3536)">
                <path d="M12.0221 8.39746L15.0392 13.378" stroke="url(#paint11_linear_20020_3536)" stroke-linecap="round" />
            </g>
            <g filter="url(#filter7_ii_20020_3536)">
                <path d="M20.308 29.2687C21.2052 29.699 22.2105 29.9401 23.2721 29.9401C26.0371 29.9401 28.4201 28.3048 29.5068 25.9485L29.5247 25.9531C30.4796 23.9932 30.303 22.3465 30.1565 20.9805C30.1208 20.6475 30.0869 20.3313 30.0716 20.0312C30.0254 19.1244 30.0333 17.5853 30.0511 16.4264C30.0526 16.4065 30.0539 16.3866 30.0548 16.3666L30.2112 13.1215C30.2693 11.9173 29.3401 10.894 28.1359 10.836C26.9317 10.778 25.9084 11.7071 25.8504 12.9113L25.8411 13.1034L22.9948 7.71065C22.4504 6.67919 21.1707 6.28554 20.1392 6.82995C19.5909 7.11938 19.2218 7.61635 19.0782 8.17337L18.8133 7.74364C18.2014 6.75076 16.8983 6.44327 15.9054 7.05522C14.9125 7.66716 14.6016 8.96945 15.2135 9.96233L15.2977 10.0988C14.8156 10.0168 14.3028 10.103 13.8538 10.3797C12.8728 10.9844 12.5677 12.2698 13.1723 13.2508L13.699 14.1053C13.1602 13.964 12.5667 14.0349 12.0551 14.3502C11.0622 14.9621 10.7534 16.2631 11.3654 17.256L16.743 25.9811C17.8529 27.7344 19.2713 28.7714 20.308 29.2687Z" fill="url(#paint12_radial_20020_3536)" />
            </g>
            <path d="M20.308 29.2687C21.2052 29.699 22.2105 29.9401 23.2721 29.9401C26.0371 29.9401 28.4201 28.3048 29.5068 25.9485L29.5247 25.9531C30.4796 23.9932 30.303 22.3465 30.1565 20.9805C30.1208 20.6475 30.0869 20.3313 30.0716 20.0312C30.0254 19.1244 30.0333 17.5853 30.0511 16.4264C30.0526 16.4065 30.0539 16.3866 30.0548 16.3666L30.2112 13.1215C30.2693 11.9173 29.3401 10.894 28.1359 10.836C26.9317 10.778 25.9084 11.7071 25.8504 12.9113L25.8411 13.1034L22.9948 7.71065C22.4504 6.67919 21.1707 6.28554 20.1392 6.82995C19.5909 7.11938 19.2218 7.61635 19.0782 8.17337L18.8133 7.74364C18.2014 6.75076 16.8983 6.44327 15.9054 7.05522C14.9125 7.66716 14.6016 8.96945 15.2135 9.96233L15.2977 10.0988C14.8156 10.0168 14.3028 10.103 13.8538 10.3797C12.8728 10.9844 12.5677 12.2698 13.1723 13.2508L13.699 14.1053C13.1602 13.964 12.5667 14.0349 12.0551 14.3502C11.0622 14.9621 10.7534 16.2631 11.3654 17.256L16.743 25.9811C17.8529 27.7344 19.2713 28.7714 20.308 29.2687Z" fill="url(#paint13_radial_20020_3536)" />
            <g filter="url(#filter8_f_20020_3536)">
                <path d="M18.6802 24.3465L14.3332 16.9779C14.0954 16.5748 14.2089 16.0565 14.5934 15.7897C15.0022 15.5061 15.564 15.611 15.8429 16.0231L18.2998 19.6545C18.5088 19.9634 18.9304 20.0409 19.2355 19.8265C19.5269 19.6217 19.606 19.2242 19.4152 18.9236L15.5853 12.8878C15.3454 12.5098 15.4333 12.0112 15.788 11.738C16.1979 11.4223 16.7915 11.5342 17.0582 11.9777L20.7907 18.1826C20.9725 18.4849 21.3681 18.5776 21.6653 18.3875C21.9474 18.207 22.0378 17.8366 21.8705 17.5465L17.5913 10.1258C17.315 9.64677 17.5016 9.03394 17.9979 8.79C18.4479 8.56879 18.9924 8.73283 19.2453 9.16584L23.6504 16.7067C23.8098 16.9796 24.1649 17.0637 24.4297 16.8913C24.672 16.7337 24.752 16.416 24.6133 16.1623L21.7345 10.8983C21.4933 10.4571 21.6566 9.90391 22.0988 9.66455C22.5337 9.42916 23.077 9.58517 23.3207 10.0154L26.6561 15.9037C26.6597 15.7796 26.7317 15.153 26.8291 14.7509C27.1586 13.392 27.6035 12.8609 28.0867 12.8609C28.5883 12.8609 29.1783 13.0746 29.0172 14.6491C28.6974 17.775 28.9591 19.9413 29.0172 20.3483C29.0754 20.7554 29.9701 25.1105 25.841 26.9424C22.5378 28.4079 19.6009 25.8488 18.6802 24.3465Z" fill="url(#paint14_radial_20020_3536)" />
            </g>
            <rect x="10.2574" y="15.4583" width="4.22359" height="14.5754" rx="2.1118" transform="rotate(-31.6469 10.2574 15.4583)" fill="url(#paint15_radial_20020_3536)" />
            <path d="M13.8538 10.3798C12.8728 10.9844 12.5677 12.2699 13.1723 13.2509L13.6989 14.1053C14.2058 14.2382 14.6643 14.5587 14.9609 15.04L19.8479 22.9691C20.3777 23.1053 20.9599 23.0342 21.4623 22.7246C22.4434 22.1199 22.7485 20.8345 22.1439 19.8535L16.7249 11.0613C16.1203 10.0803 14.8349 9.77515 13.8538 10.3798Z" fill="url(#paint16_radial_20020_3536)" />
            <path d="M13.8538 10.3798C12.8728 10.9844 12.5677 12.2699 13.1723 13.2509L13.6989 14.1053C14.2058 14.2382 14.6643 14.5587 14.9609 15.04L19.8479 22.9691C20.3777 23.1053 20.9599 23.0342 21.4623 22.7246C22.4434 22.1199 22.7485 20.8345 22.1439 19.8535L16.7249 11.0613C16.1203 10.0803 14.8349 9.77515 13.8538 10.3798Z" fill="url(#paint17_radial_20020_3536)" />
            <path d="M15.9054 7.05529C14.9125 7.66724 14.6016 8.96953 15.2135 9.96241L15.2977 10.0989C15.8689 10.196 16.397 10.5293 16.725 11.0613L22.0386 19.6827C22.5308 19.7692 23.0554 19.6827 23.5139 19.4001C24.5068 18.7881 24.8178 17.4858 24.2058 16.493L18.8133 7.74372C18.2014 6.75084 16.8983 6.44335 15.9054 7.05529Z" fill="url(#paint18_radial_20020_3536)" />
            <path d="M15.9054 7.05529C14.9125 7.66724 14.6016 8.96953 15.2135 9.96241L15.2977 10.0989C15.8689 10.196 16.397 10.5293 16.725 11.0613L22.0386 19.6827C22.5308 19.7692 23.0554 19.6827 23.5139 19.4001C24.5068 18.7881 24.8178 17.4858 24.2058 16.493L18.8133 7.74372C18.2014 6.75084 16.8983 6.44335 15.9054 7.05529Z" fill="url(#paint19_radial_20020_3536)" />
            <path d="M19.0782 8.17339L24.2058 16.4929C24.6727 17.2505 24.6024 18.1882 24.1017 18.8619C24.671 19.8272 25.9065 20.183 26.9081 19.6544C27.9395 19.11 28.3365 17.8313 27.7921 16.7998L22.9948 7.71065C22.4504 6.67919 21.1707 6.28554 20.1392 6.82995C19.5909 7.11938 19.2218 7.61636 19.0782 8.17339Z" fill="url(#paint20_radial_20020_3536)" />
            <path d="M19.0782 8.17339L24.2058 16.4929C24.6727 17.2505 24.6024 18.1882 24.1017 18.8619C24.671 19.8272 25.9065 20.183 26.9081 19.6544C27.9395 19.11 28.3365 17.8313 27.7921 16.7998L22.9948 7.71065C22.4504 6.67919 21.1707 6.28554 20.1392 6.82995C19.5909 7.11938 19.2218 7.61636 19.0782 8.17339Z" fill="url(#paint21_radial_20020_3536)" />
            <path d="M28.5935 18.3233L25.841 13.1058L25.8504 12.9114C25.9084 11.7072 26.9317 10.778 28.1359 10.8361C29.3401 10.8941 30.2693 11.9174 30.2112 13.1216L30.0548 16.3666C30.0107 17.2821 29.4087 18.0386 28.5935 18.3233Z" fill="url(#paint22_radial_20020_3536)" />
            <g filter="url(#filter9_f_20020_3536)">
                <path d="M13.7435 16L17.1808 21.1379" stroke="#FCC8A8" stroke-width="1.25" stroke-linecap="round" />
            </g>
            <g filter="url(#filter10_f_20020_3536)">
                <path d="M15.431 11.5938L20.4348 18.9686" stroke="#FFCDAB" stroke-width="1.25" stroke-linecap="round" />
            </g>
            <g filter="url(#filter11_f_20020_3536)">
                <path d="M17.5247 8.39746L23.0861 17.0103" stroke="#FFCEA8" stroke-width="1.25" stroke-linecap="round" />
            </g>
            <g filter="url(#filter12_f_20020_3536)">
                <path d="M21.3372 8.125L25.4663 15.323" stroke="#FFD0A9" stroke-width="1.25" stroke-linecap="round" />
            </g>
            <g filter="url(#filter13_f_20020_3536)">
                <path d="M28.5093 12.5868C28.1988 15.3199 28.3406 18.9264 28.5093 21.2885" stroke="url(#paint23_linear_20020_3536)" stroke-width="1.25" stroke-linecap="round" />
            </g>
        </g>
    }
    else if (ConfettiPiece.Type is ConfettiType.Star)
    {
        <g transform="scale(@(@ConfettiPiece.Size / 20))">
            <g filter="url(#filter0_iii_18_14837)">
                <path d="M18.6046 3.74448L20.8077 8.36425C21.1488 9.05025 21.771 9.5326 22.4934 9.63978L27.4208 10.3365C29.9595 10.7117 30.9171 13.4375 28.9483 15.4219L25.4952 18.9844C24.9333 19.5417 24.6724 20.3671 24.8128 21.171L25.5889 26.2344C26.0304 28.8605 23.8186 30.7236 21.5809 29.5231L17.0454 27.1114C16.4133 26.7791 15.6708 26.7791 15.0386 27.1114L10.5031 29.5231C8.26548 30.7128 5.91705 28.9062 6.5733 26.1719L7.33893 21.2188C7.47941 20.4148 7.21852 19.5895 6.6566 19.0322L3.13576 15.3438C1.15142 13.3828 2.12453 10.7117 4.66319 10.3365L9.40939 9.63978C10.1319 9.5326 10.9609 9.06097 11.2921 8.36425L13.5397 3.74448C14.6836 1.41851 17.4707 1.41851 18.6046 3.74448Z" fill="url(#paint0_radial_18_14837)" />
                <path d="M18.6046 3.74448L20.8077 8.36425C21.1488 9.05025 21.771 9.5326 22.4934 9.63978L27.4208 10.3365C29.9595 10.7117 30.9171 13.4375 28.9483 15.4219L25.4952 18.9844C24.9333 19.5417 24.6724 20.3671 24.8128 21.171L25.5889 26.2344C26.0304 28.8605 23.8186 30.7236 21.5809 29.5231L17.0454 27.1114C16.4133 26.7791 15.6708 26.7791 15.0386 27.1114L10.5031 29.5231C8.26548 30.7128 5.91705 28.9062 6.5733 26.1719L7.33893 21.2188C7.47941 20.4148 7.21852 19.5895 6.6566 19.0322L3.13576 15.3438C1.15142 13.3828 2.12453 10.7117 4.66319 10.3365L9.40939 9.63978C10.1319 9.5326 10.9609 9.06097 11.2921 8.36425L13.5397 3.74448C14.6836 1.41851 17.4707 1.41851 18.6046 3.74448Z" fill="url(#paint1_radial_18_14837)" />
            </g>
            <path d="M18.6046 3.74448L20.8077 8.36425C21.1488 9.05025 21.771 9.5326 22.4934 9.63978L27.4208 10.3365C29.9595 10.7117 30.9171 13.4375 28.9483 15.4219L25.4952 18.9844C24.9333 19.5417 24.6724 20.3671 24.8128 21.171L25.5889 26.2344C26.0304 28.8605 23.8186 30.7236 21.5809 29.5231L17.0454 27.1114C16.4133 26.7791 15.6708 26.7791 15.0386 27.1114L10.5031 29.5231C8.26548 30.7128 5.91705 28.9062 6.5733 26.1719L7.33893 21.2188C7.47941 20.4148 7.21852 19.5895 6.6566 19.0322L3.13576 15.3438C1.15142 13.3828 2.12453 10.7117 4.66319 10.3365L9.40939 9.63978C10.1319 9.5326 10.9609 9.06097 11.2921 8.36425L13.5397 3.74448C14.6836 1.41851 17.4707 1.41851 18.6046 3.74448Z" fill="url(#paint2_radial_18_14837)" />
            <path d="M18.6046 3.74448L20.8077 8.36425C21.1488 9.05025 21.771 9.5326 22.4934 9.63978L27.4208 10.3365C29.9595 10.7117 30.9171 13.4375 28.9483 15.4219L25.4952 18.9844C24.9333 19.5417 24.6724 20.3671 24.8128 21.171L25.5889 26.2344C26.0304 28.8605 23.8186 30.7236 21.5809 29.5231L17.0454 27.1114C16.4133 26.7791 15.6708 26.7791 15.0386 27.1114L10.5031 29.5231C8.26548 30.7128 5.91705 28.9062 6.5733 26.1719L7.33893 21.2188C7.47941 20.4148 7.21852 19.5895 6.6566 19.0322L3.13576 15.3438C1.15142 13.3828 2.12453 10.7117 4.66319 10.3365L9.40939 9.63978C10.1319 9.5326 10.9609 9.06097 11.2921 8.36425L13.5397 3.74448C14.6836 1.41851 17.4707 1.41851 18.6046 3.74448Z" fill="url(#paint3_radial_18_14837)" />
            <path d="M18.6046 3.74448L20.8077 8.36425C21.1488 9.05025 21.771 9.5326 22.4934 9.63978L27.4208 10.3365C29.9595 10.7117 30.9171 13.4375 28.9483 15.4219L25.4952 18.9844C24.9333 19.5417 24.6724 20.3671 24.8128 21.171L25.5889 26.2344C26.0304 28.8605 23.8186 30.7236 21.5809 29.5231L17.0454 27.1114C16.4133 26.7791 15.6708 26.7791 15.0386 27.1114L10.5031 29.5231C8.26548 30.7128 5.91705 28.9062 6.5733 26.1719L7.33893 21.2188C7.47941 20.4148 7.21852 19.5895 6.6566 19.0322L3.13576 15.3438C1.15142 13.3828 2.12453 10.7117 4.66319 10.3365L9.40939 9.63978C10.1319 9.5326 10.9609 9.06097 11.2921 8.36425L13.5397 3.74448C14.6836 1.41851 17.4707 1.41851 18.6046 3.74448Z" fill="url(#paint4_radial_18_14837)" />
            <path d="M18.6046 3.74448L20.8077 8.36425C21.1488 9.05025 21.771 9.5326 22.4934 9.63978L27.4208 10.3365C29.9595 10.7117 30.9171 13.4375 28.9483 15.4219L25.4952 18.9844C24.9333 19.5417 24.6724 20.3671 24.8128 21.171L25.5889 26.2344C26.0304 28.8605 23.8186 30.7236 21.5809 29.5231L17.0454 27.1114C16.4133 26.7791 15.6708 26.7791 15.0386 27.1114L10.5031 29.5231C8.26548 30.7128 5.91705 28.9062 6.5733 26.1719L7.33893 21.2188C7.47941 20.4148 7.21852 19.5895 6.6566 19.0322L3.13576 15.3438C1.15142 13.3828 2.12453 10.7117 4.66319 10.3365L9.40939 9.63978C10.1319 9.5326 10.9609 9.06097 11.2921 8.36425L13.5397 3.74448C14.6836 1.41851 17.4707 1.41851 18.6046 3.74448Z" fill="url(#paint5_radial_18_14837)" />
        </g>
    }
    <animateMotion @ref=animateReference
                   dur="@(ConfettiPiece.Milliseconds)ms"
                   repeatCount="1"
                   path="@SmoothPath(ConfettiPiece.Positions)"
                   begin="indefinite"
                   fill="freeze" />
</g>

@code {
    private ElementReference animateReference { get; set; }
    private SVGAnimationElement? animationElement;

    [Inject]
    public required IJSRuntime JSRuntime { get; set; }

    [Parameter, EditorRequired]
    public required ConfettiPiece ConfettiPiece { get; set; }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (!firstRender) return;

        try
        {
            animationElement = await SVGAnimationElement.CreateAsync(JSRuntime, animateReference);

            await animationElement.BeginElementAsync();
            await animationElement.EndElementAtAsync(ConfettiPiece.Milliseconds);
        }
        catch (Exception e)
        {
#if DEBUG
    Console.WriteLine(e);
#endif
        }
    }

    private string SmoothPath((double X, double Y)[] points)
    {
        // Parameter for smoothness of path in interval [0, 0.5]
        double smoothness = 1.0 / 3.0;

        var result = "";
        if (points.Length >= 2)
        {
            result = $"M {points[0].X.AsString()} {points[0].Y.AsString()} ";
            for (int i = 1; i < points.Length - 1; i++)
            {
                result += $"S {(points[i - 1].X * smoothness / 2 + points[i].X - points[i + 1].X * smoothness / 2).AsString()} {(points[i - 1].Y * smoothness / 2 + points[i].Y - points[i + 1].Y * smoothness / 2).AsString()} {points[i].X.AsString()} {points[i].Y.AsString()} ";
            }
            result += $"S {(points[^2].X * smoothness + points[^1].X * (1 - smoothness)).AsString()} {(points[^2].Y * smoothness + points[^1].Y * (1 - smoothness)).AsString()} {points[^1].X.AsString()} {points[^1].Y.AsString()} ";
        }
        return result;
    }
}